<%= user_header(@user) %>

<h2>Profile Settings</h2>

<% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
  <div>
    <p>
      Currently waiting confirmation for your email:
      <%= content_tag :strong, resource.unconfirmed_email %>
    </p>

    <%= content_tag :p, link_to("Didn't receive confirmation instructions?",
                                new_confirmation_path(resource_name)) %>
  </div>
<% else %>
  <div class="columns">
    <div class="first-column">
      <h3>Change My Password</h3>

      <%= form_for(resource, as: resource_name,
                             url: registration_path(resource_name),
                             html: { method: :put, name: 'user_form',
                                     class: 'user-registration-form',
                                     novalidate: 'novalidate' }) do |form| %>
        <%= form_errors(form.object) %>

        <div class="field disabled">
          <%= form.label :email %>
          <%= form.email_field :email, disabled: true %>
        </div>

        <div class="field">
          <div class="field-label-and-message">
            <%= form.label :password, "New password" %>
            <%= content_tag :span, "#{@minimum_password_length} characters minimum",
                            class: 'field-message' %>
          </div>
          <%= form.password_field :password, autofocus: false,
                                             autocomplete: "new-password" %>
        </div>

        <div class="field">
          <%= required_field_label form, :password_confirmation %>
          <%= form.password_field :password_confirmation,
                                  autocomplete: "new-password" %>
        </div>

        <div class="field">
          <%= required_field_label form, :current_password %>
          <%= form.password_field :current_password,
                                  autocomplete: "current-password",
                                  placeholder: 'we need your current one to confirm the change' %>
        </div>

        <div class="actions">
          <%= form.submit "Update" %>
        </div>
      <% end %>

      <h3>Cancel my account</h3>

      <p>
        Unhappy?
        <%= button_to "Cancel my account",
                      registration_path(resource_name),
                      data: { confirm: "Are you sure?" },
                      method: :delete,
                      class: 'button button-outline button-warning' %>
      </p>
    </div>

    <div class="second-column"></div>
  </div>

  <%= content_tag :p, link_to("Back", :back) %>
<% end %>
