<% if issue_subscription.persisted? %>
  <% return unless can?(:destroy, issue_subscription) %>

  <%= link_to '', issue_issue_subscription_path(issue, issue_subscription),
              method: :delete,
              class: 'button button-success button-unsubscribe' %>
<% elsif issue&.project&.category&.subscribed_to_issues?(current_user) %>
  <%= link_to 'Subscribed Thru Category', 'javascript:void(0)',
              class: 'button button-success button-disabled' %>
<% elsif issue&.project&.subscribed_to_issues?(current_user) %>
  <%= link_to 'Subscribed Thru Project', 'javascript:void(0)',
              class: 'button button-success button-disabled' %>
<% elsif issue && can?(:create, issue_subscription) %>
  <%= link_to 'Subscribe to issue',
              issue_issue_subscriptions_path(issue),
              method: :post, class: 'button button-outline' %>
<% end %>
