<%
  filter_form_path =
    if @project
      project_tasks_path(@project)
    elsif @category
      category_tasks_path(@category)
    elsif @user
      user_tasks_path(@user)
    end
%>

<% if @category && @project %>
  <%= project_header @project %>
  <header class="tasks-header">
    <h2>Project Tasks</h2>
    <% if can?(:create, @project.tasks.build(user_id: current_user.id)) %>
      <p>
        <%= link_to 'Add Task', new_project_task_path(@project),
                    class: 'button button-success' %>
      </p>
    <% end %>
  </header>

<% elsif @category %>
  <%= category_header @category %>
  <header class="tasks-header">
    <h2>Category Tasks</h2>
  </header>

<% elsif @user %>
  <%= user_header @user %>
  <header class="tasks-header">
    <h2>Created Tasks</h2>
  </header>
<% else %>
  <h1>All Tasks</h1>
  <header class="tasks-header"></header>
<% end %>

<%= render 'tasks/tasks', tasks: @tasks,
                          path: filter_form_path %>
