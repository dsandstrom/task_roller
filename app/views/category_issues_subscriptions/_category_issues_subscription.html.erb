<%
  category ||= category_issues_subscription.category
  return unless category

  button_class ||= ''
  button_class = "button #{button_class}"
%>

<% if category_issues_subscription.persisted? %>
  <% return unless can?(:destroy, category_issues_subscription) %>

  <% url = category_issues_subscription_path(category,
                                             category_issues_subscription) %>

  <%= link_to 'Auto-Subscribed', url,
              method: :delete,
              class: "#{button_class} button-success button-disable-subscribe",
              data: { disable_with: 'Unsubscribing' } %>
<% elsif can?(:create, category_issues_subscription) %>
  <%= link_to 'Auto-Subscribe to New Issues',
              category_issues_subscriptions_path(category),
              method: :post, class: button_class,
              data: { disable_with: 'Subscribing' } %>
<% end %>
